"use strict";
Object.defineProperty(exports, Symbol.toStringTag, { value: "Module" });
const path = require("path");
const routerGenerator = require("@tanstack/router-generator");
const CONFIG_FILE_NAME = "tsr.config.json";
function TanStackRouterVite(inlineConfig = {}) {
  const ROOT = process.cwd();
  let userConfig;
  const generate = async () => {
    try {
      await routerGenerator.generator(userConfig);
    } catch (err) {
      console.error(err);
      console.info();
    }
  };
  return {
    name: "vite-plugin-tanstack-router",
    configResolved: async () => {
      userConfig = await routerGenerator.getConfig(inlineConfig, ROOT);
      await generate();
    },
    handleHotUpdate: async ({ file }) => {
      const filePath = path.normalize(file);
      if (filePath === path.join(ROOT, CONFIG_FILE_NAME)) {
        userConfig = await routerGenerator.getConfig(inlineConfig, ROOT);
        return;
      }
      const routesDirectoryPath = path.isAbsolute(userConfig.routesDirectory) ? userConfig.routesDirectory : path.join(ROOT, userConfig.routesDirectory);
      if (filePath.startsWith(routesDirectoryPath)) {
        await generate();
      }
    }
  };
}
exports.TanStackRouterVite = TanStackRouterVite;
//# sourceMappingURL=index.cjs.map
